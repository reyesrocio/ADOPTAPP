<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Gestión de Mascotas | ADOPTAPP</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }
        th {
            background-color: #eee;
        }
        button {
            padding: 5px 10px;
            margin: 2px;
            cursor: pointer;
        }
        #agregarMascota {
            margin-top: 20px;
            padding: 10px 20px;
        }
        input[type="text"] {
            padding: 5px;
            margin: 5px;
        }
    </style>
</head>
<body>

<h1>Panel de Gestión de Mascotas</h1>

<table id="tablaMascotas">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>Tipo</th>
            <th>Edad</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        <!-- Aquí se cargarán las mascotas -->
    </tbody>
</table>

<h3>Agregar / Editar Mascota</h3>
<form id="formMascota">
    <input type="hidden" id="indexMascota">
    <input type="text" id="nombreMascota" placeholder="Nombre" required>
    <input type="text" id="tipoMascota" placeholder="Tipo" required>
    <input type="text" id="edadMascota" placeholder="Edad" required>
    <button type="submit">Guardar</button>
</form>

<button id="logoutBtn">Cerrar sesión</button>

<script>
    // Redirigir si no está logueado como admin
    if (localStorage.getItem("adminLogueado") !== "true") {
        window.location.href = "admin.html";
    }

    let mascotas = JSON.parse(localStorage.getItem("mascotasDB")) || [];

    const tablaBody = document.querySelector("#tablaMascotas tbody");
    const form = document.getElementById("formMascota");
    const nombreInput = document.getElementById("nombreMascota");
    const tipoInput = document.getElementById("tipoMascota");
    const edadInput = document.getElementById("edadMascota");
    const indexInput = document.getElementById("indexMascota");

    function mostrarMascotas() {
        tablaBody.innerHTML = "";
        mascotas.forEach((mascota, index) => {
            const fila = document.createElement("tr");
            fila.innerHTML = `
                <td>${mascota.nombre}</td>
                <td>${mascota.tipo}</td>
                <td>${mascota.edad}</td>
                <td>
                    <button onclick="editarMascota(${index})">Editar</button>
                    <button onclick="eliminarMascota(${index})">Eliminar</button>
                </td>
            `;
            tablaBody.appendChild(fila);
        });
    }

    function editarMascota(index) {
        const mascota = mascotas[index];
        nombreInput.value = mascota.nombre;
        tipoInput.value = mascota.tipo;
        edadInput.value = mascota.edad;
        indexInput.value = index;
    }

    function eliminarMascota(index) {
        if (confirm("¿Deseas eliminar esta mascota?")) {
            mascotas.splice(index, 1);
            localStorage.setItem("mascotasDB", JSON.stringify(mascotas));
            mostrarMascotas();
        }
    }

    form.addEventListener("submit", function(e) {
        e.preventDefault();
        const nuevaMascota = {
            nombre: nombreInput.value,
            tipo: tipoInput.value,
            edad: edadInput.value
        };
        const index = indexInput.value;
        if (index === "") {
            // Agregar nueva mascota
            mascotas.push(nuevaMascota);
        } else {
            // Editar mascota existente
            mascotas[index] = nuevaMascota;
        }
        localStorage.setItem("mascotasDB", JSON.stringify(mascotas));
        form.reset();
        indexInput.value = "";
        mostrarMascotas();
    });

    document.getElementById("logoutBtn").addEventListener("click", function() {
        localStorage.removeItem("adminLogueado");
        window.location.href = "admin.html";
    });

    // Mostrar las mascotas al cargar la página
    mostrarMascotas();
</script>

</body>
</html>
